{% extends "base.html" %}
{% load static %}

{% block title %}–ê—Ñ–∏—à–∞ —Å–æ–±—ã—Ç–∏–π –ê–ª–º–∞—Ç—ã | Damuway{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/event/event.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>
{% endblock %}

{% block content %}
<div class="event-page">

    <!-- üî• –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <h1 class="event-title">–ê—Ñ–∏—à–∞ —Å–æ–±—ã—Ç–∏–π –ê–ª–º–∞—Ç—ã</h1>

    <!-- üìÜ –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
    <div class="calendar-row">
        <div class="calendar-month">–ú–∞–π</div>
        <div class="calendar-days">
            {% for day in calendar_days %}
                {% if day == today.day %}
                    <button class="calendar-day today">{{ day }}</button>
                {% else %}
                    <button class="calendar-day">{{ day }}</button>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <!-- üìå –ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ -->
    <div class="calendar-buttons">
        <a href="?date={{ today }}" class="calendar-btn">–°–µ–≥–æ–¥–Ω—è</a>
        <a href="?date={{ today|add:"1 day" }}" class="calendar-btn">–ó–∞–≤—Ç—Ä–∞</a>
        <a href="?weekend=true" class="calendar-btn">–í—ã—Ö–æ–¥–Ω—ã–µ</a>
        <input type="date" name="date" class="calendar-picker"
               onchange="window.location.href='?date=' + this.value;">
    </div>

    <!-- üéâ –°–ª–∞–π–¥–µ—Ä -->
    <div class="swiper mySwiper">
        <div class="swiper-wrapper">
            {% for event in featured_events %}
            <div class="swiper-slide slide-hero">
                <img src="{{ event.image.url }}" alt="{{ event.title }}" class="slide-img">
                <div class="slide-content">
                    <h2>{{ event.title }}</h2>
                    {% if event.ticket_link %}
                        <a href="{{ event.ticket_link }}" class="btn-buy" target="_blank">–ö—É–ø–∏—Ç—å –±–∏–ª–µ—Ç</a>
                    {% else %}
                        <a href="{% url 'event_detail' event.id %}" class="btn-buy">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="swiper-pagination"></div>
    </div>

    <!-- üß≤ –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ -->
    <div class="section-heading">
        <h2>–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</h2>
    </div>

    <!-- üéü –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–æ–±—ã—Ç–∏–π -->
    <div class="event-grid">
        {% for event in events %}
        <a href="{% url 'event_detail' event.id %}" class="event-card">
            <img src="{{ event.image.url }}" alt="{{ event.title }}">
            <div class="event-info">
                <h3>{{ event.title }}</h3>
                <p>üìç {{ event.location }}</p>
                <p>üìÖ {{ event.date|date:"d M Y H:i" }}</p>
                <p>üë∂ {{ event.age_limit }} | üí∞ {{ event.price }}</p>
            </div>
        </a>
        {% empty %}
        <p class="no-events">üòî –ü–æ–∫–∞ –Ω–µ—Ç –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π.</p>
        {% endfor %}
    </div>

</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
<script>
    const swiper = new Swiper(".mySwiper", {
        loop: true,
        pagination: {
            el: ".swiper-pagination",
        },
    });
</script>
{% endblock %}
